package awsauthz_test

import (
	"context"
	"testing"

	"github.com/linkai-io/frontend/pkg/authz"
	"github.com/linkai-io/frontend/pkg/token/awstoken"

	"github.com/linkai-io/frontend/pkg/authz/awsauthz"
)

func TestRefresh(t *testing.T) {
	ctx := context.Background()
	tokener := awstoken.New("dev", "us-east-1")
	auth := awsauthz.New("dev", "us-east-1", tokener)
	if err := auth.Init(nil); err != nil {
		t.Fatalf("error initing awsauth: %v\n", err)
	}
	resp, err := auth.Refresh(ctx, &authz.TokenDetails{
		AccessToken:  "eyJraWQiOiJUczY3cE95Rk5tU2I3S3BkS1NIdXRjRDZ4XC81ZEFBYys2Wm1SR1l6YmVTcz0iLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIzYTA5OGM1MC02MTc4LTQ0OWEtYmMwYS00MDgxMjBkYWE2MTAiLCJjb2duaXRvOmdyb3VwcyI6WyJvd25lciJdLCJldmVudF9pZCI6ImI5MjgyYmM4LTI4NDYtMTFlOS1iNGRhLTUxYjUwYzZjNzRhNSIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE1NDkyNjE5ODMsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC51cy1lYXN0LTEuYW1hem9uYXdzLmNvbVwvdXMtZWFzdC0xX1FjMlNnZW9ZOCIsImV4cCI6MTU0OTI2NTU4MywiaWF0IjoxNTQ5MjYxOTgzLCJqdGkiOiIzMWRiMjE5ZC01ZTliLTRmYTYtYWIyNS00N2E1YWU4ODYzOTYiLCJjbGllbnRfaWQiOiI0ZDVnbmkxNTRjNm1hbzhhMGdnczZsajVwbyIsInVzZXJuYW1lIjoiM2EwOThjNTAtNjE3OC00NDlhLWJjMGEtNDA4MTIwZGFhNjEwIn0.GeRlkoPQ_UzdzIBE8F0qQsLi6GP0BeNTUWxC-9FUsmyAULIqqYtuNCBW2iMGMhEkNK7bt6kk8aJWgdTONYEHvA5tcmP4UOtRGZAfFB3y1WfS0gbOmGdF2cCU0qjog9PYoEqNiz77TeXN-3a9f-_tJHeCydEUARRZ2DrmqKFEusmudwZlvgxcC4VkZwik1qr6Du5ze_WifsmiIZXo9FHXYm-SaLJ6cVENQNelPDYD_UY_rTZ31KaBUbq2fcN0HJxOjZvyFUWCJ3BkdnFWMuhBphdhl4-cUMpjmX93nzID7W20bd0Z5PeSGh3HNFbAcg2gd8vdXSIDkByimUPgfuMTPQ",
		RefreshToken: "eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ.oyzcGpMw67JlWDTqsFx4Q31vR2Tagp0EcmWnvQCSdjl6e2ofdONXVkNsxIIh5FBpB6UZKWWGRPGQExqm6mBeqkgttuhVYqH6j_tdI6R_CaDLSZbTocSM19iXOnT5APEgI4ddfg6ILNT8SBbrqIO3-8EtNq4BrTtSyt77voCbPTWzGNQOkgvJ7qUXPAoHJudvRBYkhQIcdGpW8sHDPp9CAQBYc8wCb_kfLyf-o9Caot1AQzBAxg_iM9a4Y3NREXX21uBI0z8NwP7ndOSJXfBXDSoP59GvyafedWlYuc731-Yn8ImlFGbbKCzzyovkCCLEXhdZqeu5iN8Iycl-143t6Q.LNKakQ9kUtJEDDTB.HczwqSS5xgWjvtnuqQD1Nx0eNrESy9aFb2DInX8vpw1_JdhFKHN1GjEFVNokSUBZzEWHW6u40NdMnkpUSlG7TKjOkiXO3cIFoxP78BA8cuUZ_LGSHIJeKTVezc4Bww2R7v-SuizogWSSXyYri5GYbt-qpia_wvdEcR7FR1R4lkj01_SQupbmA0yqi3PPIjRWyGbZbnnIFzjyfHO_6N0M_DeK-sDIzC4pLxT0pzOX2c-Od8oD7gfajy_SQjtQRxWmxxhZUeai13fWkXI7lp7U8G4TXaNyUie68SC_Tu5-xWzitjvj-hOODswBGzZ6Zf2heYxIDuyY5FzaWO9rgbKdp6I7BKHti4Ewnlgp6hmImwDIvZb-w3_qWu6_m_V1hrmkVkNsz4hFpymJZmjAncfSsnip9ToRYFoPFqmj9E5hd-VAl0sOGJWm4gz2etDvvikYU3RdlODWWLhjF-HgobgEj5r7PUiN7NRXZNmyBKQQrqLnej4pgW2cIU78PIMjPpqgKKo-zRPDLad2VzUq4Bua6hkHuABgMVp6ceyjsKBXuPmKOsBUV8G0Mv7j0sq_gfvZzm1EaJbfWApR4pzs6iPHXYGlOUy7GSLo7t4maNrS3SuMKWgg1pPrvkQQk_JJqwtAJZSL6-o3MHGQ7GSt_KVect4anhHwN-oz-dSGCim4EBwoRJUuka9nNrYrux3oAIpk-VJ3J38DSS13Nvbb0YKS1UdQNOzApK5JNHkcQguVhjmlx9hZ4R5NsgtytM2M5yGDQQOCbUH03ytkq8sh69pZjzyYL31FaHrA65tnsoLpS9GV-y00eW2z97Iqk4tyWHNHWcMtMrSEa-bPBafVNeq93YHr3JPJyXo56z4nAh7u2xjAfi_0AKgxQM_Z7CJyzYXxGtKBNaH9znTdo8fjO4yOLpr3HdOq092NsrAxNpGNUxsc0E2ZjY8RTlq33V1mXFIMsv7fnRarvOvwRd1PIKH3hwblfL9EtXhfL8jw8MuV6PTaD2PlWacqKsQRE49P8aeR0mexnMvqTaTlS8TYiTnO6QZTkfoD_4ff9Bx39XXDTPpfJFuiUmPk2HYjnPkTwCjLw47SU2XaUYTD5KLbbLxeYtJ3vvdRYKWi5SU5qmPWKZ8kotV1YgaTiEx7uszi8WCtQP4DXkFcgoOF9sc4kdNghXKJPnB8aIvxFf48WYGApo8BhLOH_h2ZRdM9kkqjjlk_c7sWUIcuVFYkIyelFZKBdl2CJzjNwsrqRVqfj79Dtsr8jxOgmVPJwzABcw6qBeKIaBDjZFgwDphzmmdlClhPDiIO09f9jh3rMD1IFJ1VvqfgGJzs0pZVd3db9Q.I4WzrNBTvocKu2gXiHoDig",
	})

	if err != nil {
		t.Fatalf("error: %v\n", err)
	}
	t.Logf("%#v\n", resp)
}
